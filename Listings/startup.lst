


ARM Macro Assembler    Page 1 


    1 00000000                 GET              common.s
    1 00000000         ;×Ô¼ºÈ·¶¨±äÁ¿µÄµØÖ·
    2 00000000 20004900 
                       SEG_QIAN
                               EQU              0X20004900  ;´æ´¢ÊýÂë¹ÜµÄÇ§Î»
    3 00000000 20004904 
                       SEG_BAI EQU              0X20004904  ;´æ´¢ÊýÂë¹ÜµÄ°ÙÎ»
    4 00000000 20004908 
                       SEG_SHI EQU              0X20004908  ;´æ´¢ÊýÂë¹ÜµÄÊ®Î»
    5 00000000 2000490C 
                       SEG_GE  EQU              0X2000490C  ;´æ´¢ÊýÂë¹ÜµÄ¸öÎ»
    6 00000000 20004910 
                       SEG_CNT EQU              0X20004910  ;¿ØÖÆÊýÂë¹ÜµÄË¢ÐÂË³
                                                            Ðò
    7 00000000         ;¼Ä´æÆ÷µÄ¶¨Òå 
    8 00000000 40010800 
                       GPIOA_CRL
                               EQU              0x40010800  ;¶Ë¿ÚÅäÖÃµÍ¼Ä´æÆ÷ 
    9 00000000 40010808 
                       GPIOA_IDR
                               EQU              0x40010808  ;¶Ë¿ÚÊäÈëÊý¾Ý¼Ä´æÆ÷
                                                            
   10 00000000 4001080C 
                       GPIOA_ODR
                               EQU              0x4001080c  ;¶Ë¿ÚÊä³öÊý¾Ý¼Ä´æÆ÷
                                                            
   11 00000000 40010C00 
                       GPIOB_CRL
                               EQU              0x40010C00  ;¶Ë¿ÚÅäÖÃµÍ¼Ä´æÆ÷ 
   12 00000000 40010C04 
                       GPIOB_CRH
                               EQU              0x40010C04  ;¶Ë¿ÚÅäÖÃµÍ¼Ä´æÆ÷ 
   13 00000000 40010C08 
                       GPIOB_IDR
                               EQU              0x40010C08  ;¶Ë¿ÚÊäÈëÊý¾Ý¼Ä´æÆ÷
                                                            
   14 00000000 40010C0C 
                       GPIOB_ODR
                               EQU              0x40010C0c  ;¶Ë¿ÚÊä³öÊý¾Ý¼Ä´æÆ÷
                                                            
   15 00000000 40011004 
                       GPIOC_CRH
                               EQU              0x40011004  ;¶Ë¿ÚÅäÖÃ¸ß¼Ä´æÆ÷ 
   16 00000000 4001100C 
                       GPIOC_ODR
                               EQU              0x4001100C  ;¶Ë¿ÚÊä³öÊý¾Ý¼Ä´æÆ÷
                                                             
   17 00000000 40021018 
                       RCC_APB2ENR
                               EQU              0x40021018  ;ÍâÉèÊ±ÖÓÊ¹ÄÜ¼Ä´æÆ÷
                                                            
   18 00000000 4002101C 
                       RCC_APB1ENR
                               EQU              0x4002101C  ;ÍâÉèÊ±ÖÓÊ¹ÄÜ¼Ä´æÆ÷
                                                            
   19 00000000 40021000 
                       RCC_CR  EQU              0x40021000  ;¿ØÖÆ¼Ä´æÆ÷
   20 00000000 40021004 
                       RCC_CFGR



ARM Macro Assembler    Page 2 


                               EQU              0x40021004  ;ÅäÖÃ¼Ä´æÆ÷
   21 00000000 40000000 
                       TIM2_CR1
                               EQU              0x40000000  ;¿ØÖÆ¼Ä´æÆ÷
   22 00000000 40000028 
                       TIM2_PSC
                               EQU              0x40000028  ;Ô¤·ÖÆµ¼Ä´æÆ÷
   23 00000000 4000002C 
                       TIM2_ARR
                               EQU              0x4000002C  ;ÖØ×°Öµ¼Ä´æÆ÷
   24 00000000 4000000C 
                       TIM2_DIER
                               EQU              0x4000000C  ;dma/ÖÐ¶ÏÊ¹ÄÜ¼Ä´æÆ÷
                                                            
   25 00000000 40000010 
                       TIM2_SR EQU              0x40000010  ;×´Ì¬¼Ä´æÆ÷ 
   26 00000000 40000400 
                       TIM3_CR1
                               EQU              0x40000400  ;¿ØÖÆ¼Ä´æÆ÷ 
   27 00000000 40000428 
                       TIM3_PSC
                               EQU              0x40000428  ;Ô¤·ÖÆµ¼Ä´æÆ÷
   28 00000000 4000042C 
                       TIM3_ARR
                               EQU              0x4000042C  ;ÖØ×°Öµ¼Ä´æÆ÷
   29 00000000 4000040C 
                       TIM3_DIER
                               EQU              0x4000040C  ;dma/ÖÐ¶ÏÊ¹ÄÜ¼Ä´æÆ÷
                                                            
   30 00000000 40000410 
                       TIM3_SR EQU              0x40000410  ;×´Ì¬¼Ä´æÆ÷
   31 00000000 40000424 
                       TIM3_CNT
                               EQU              0x40000424  ;¼ÆÊýÆ÷
   32 00000000 E000E100 
                       NVIC_SETENA0
                               EQU              0xE000E100  ;ÖÐ¶ÏÉèÖÃÊ¹ÄÜ¼Ä´æÆ÷
                                                            
   33 00000000 E000E180 
                       NVIC_CLREA0
                               EQU              0xE000E180  ;ÖÐ¶ÏÉèÖÃ³ýÄÜ¼Ä´æÆ÷
                                                            
   34 00000000 E000E280 
                       NVIC_CLRPEN
                               EQU              0xE000E280  ;ÖÐ¶Ï¹ÒÆð¼Ä´æÆ÷
   35 00000000 E000E010 
                       SYSTICK_CSR
                               EQU              0xE000E010  ;¿ØÖÆ¼°×´Ì¬¼Ä´æÆ÷
   36 00000000 E000E014 
                       SYSTICK_RELOAD
                               EQU              0xE000E014  ;ÖØ×°Öµ¼Ä´æÆ÷
   37 00000000 E000E018 
                       SYSTICK_CURRENT
                               EQU              0xE000E018  ;µ±Ç°Öµ¼Ä´æÆ÷
   38 00000000 40003000 
                       IWDG_KR EQU              0x40003000  ;¼ü¼Ä´æÆ÷
   39 00000000 40003004 
                       IWDG_PR EQU              0x40003004  ;Ô¤·ÖÆµ¼Ä´æÆ÷
   40 00000000 40003008 



ARM Macro Assembler    Page 3 


                       IWDG_RLR
                               EQU              0x40003008  ;ÖØ×°ÔÙÔØ¼Ä´æÆ÷ 
   41 00000000 4000300C 
                       IWDG_SR EQU              0x4000300c  ;×´Ì¬¼Ä´æÆ÷
   42 00000000         ;±êºÅµ¼Èë
   43 00000000                 IMPORT           SHOW0
   44 00000000                 IMPORT           SHOW1
   45 00000000                 IMPORT           SHOW2
   46 00000000                 IMPORT           SHOW3
   47 00000000                 IMPORT           SHOW4
   48 00000000                 IMPORT           SHOW5
   49 00000000                 IMPORT           SHOW6
   50 00000000                 IMPORT           SHOW7
   51 00000000                 IMPORT           SHOW8
   52 00000000                 IMPORT           SHOW9
   53 00000000                 IMPORT           W1_ON
   54 00000000                 IMPORT           W2_ON
   55 00000000                 IMPORT           W3_ON
   56 00000000                 IMPORT           W4_ON
   57 00000000                 IMPORT           DP_ON
   58 00000000                 IMPORT           W1_OFF
   59 00000000                 IMPORT           W2_OFF
   60 00000000                 IMPORT           W3_OFF
   61 00000000                 IMPORT           W4_OFF
   62 00000000                 IMPORT           DP_OFF
   63 00000000                 AREA             HEADER, CODE, READONLY
   64 00000000                 END
    2 00000000                 IMPORT           RCC_CFG
    3 00000000                 IMPORT           TIM2_IRQHandler
    4 00000000                 IMPORT           TIM2_CFG
    5 00000000                 IMPORT           IO_CFG
    6 00000000                 IMPORT           CLK_CFG
    7 00000000                 IMPORT           cal_dis
    8 00000000                 IMPORT           SYSTICK_CLK_SOURCE
    9 00000000                 IMPORT           TIM3_CFG
   10 00000000                 IMPORT           IWDG_CFG
   11 00000000                 PRESERVE8
   12 00000000                 AREA             MY_DATA, DATA, READONLY
   13 00000000                 EXPORT           __Vectors
   14 00000000         __Vectors                            ;       
   15 00000000 20004000        DCD              0x20004000  ;0x20004000        
                                                              ; Top of Stack
   16 00000004 00000000        DCD              Reset_Handler ; Reset Handler
   17 00000008 00000000 
              00000001 
              00000002 
              00000003 
              00000004 
              00000005 
              00000006 
              00000007 
              00000008 
              00000009 
              00000000 
              00000001 
              00000002 
              00000003 
              00000004 
              00000005 



ARM Macro Assembler    Page 4 


              00000006 
              00000007 
              00000008 
              00000009         DCD              0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5
,6,7,8,9
   18 00000058 00000000 
              00000001 
              00000002 
              00000003 
              00000004 
              00000005 
              00000006 
              00000007 
              00000008 
              00000009 
              00000000 
              00000001 
              00000002 
              00000003 
              00000004 
              00000005 
              00000006 
              00000007 
              00000008 
              00000009         DCD              0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5
,6,7,8,9
   19 000000A8 00000001 
              00000002         DCD              1,2
   20 000000B0 00000000        DCD              TIM2_IRQHandler ; TIM2
   21 000000B4         
   22 000000B4                 AREA             MY_CODE, CODE, READONLY
   23 00000000         Reset_Handler
                               PROC
   24 00000000                 EXPORT           Reset_Handler
   25 00000000 F7FF FFFE       BL               RCC_CFG
   26 00000004 F7FF FFFE       BL               CLK_CFG
   27 00000008 F7FF FFFE       BL               IO_CFG
   28 0000000C F7FF FFFE       BL               TIM2_CFG
   29 00000010 F7FF FFFE       BL               TIM3_CFG
   30 00000014 F7FF FFFE       BL               SYSTICK_CLK_SOURCE
   31 00000018 F7FF FFFE       BL               IWDG_CFG
   32 0000001C         ;³õÊ¼»¯
   33 0000001C 4894            LDR              R0,=SEG_CNT
   34 0000001E F04F 0100       LDR              R1,=0
   35 00000022 6001            STR              R1,[R0]
   36 00000024 F44F 707A       LDR              R0,=1000
   37 00000028 F7FF FFFE       BL               DELAY_MS
   38 0000002C         LOOP
   39 0000002C         ;´¥·¢ÖÁÉÙ10usµÄ¸ßµçÆ½
   40 0000002C F7FF FFFE       BL               TRIG_H
   41 00000030 F04F 000F       LDR              R0,=15
   42 00000034 F7FF FFFE       BL               DELAY_US
   43 00000038         ;Êä³öµÍµçÆ½
   44 00000038 F7FF FFFE       BL               TRIG_L
   45 0000003C F04F 0100       LDR              R1,=0
   46 00000040         WAIT_ECHO1
   47 00000040 F7FF FFFE       BL               ECHO
   48 00000044 B401            PUSH             {R0}
   49 00000046 F64F 72FF       LDR              R2,=0XFFFF



ARM Macro Assembler    Page 5 


   50 0000004A F101 0101       ADD              R1,#1
   51 0000004E 4291            CMP              R1,R2
   52 00000050 DAEC            BGE              LOOP
   53 00000052 BC01            POP              {R0}
   54 00000054 F010 0F01       TST              R0,#1
   55 00000058 D0F2            BEQ              WAIT_ECHO1  ;µÈ´ýechoÊä³ö¸ßµçÆ½
                                                            
   56 0000005A         ;Çå¿Õ¼ÆÊýÆ÷,×î´ó¼ÆÊý65535us ×î´ó²âÁ¿340*(65535/2000000)=
                       11.1410m
   57 0000005A 4886            LDR              R0,=TIM3_CNT
   58 0000005C 6801            LDR              R1,[R0]
   59 0000005E F04F 0100       LDR              R1,=0
   60 00000062 6001            STR              R1,[R0]
   61 00000064         WAIT_ECHO2
   62 00000064 F7FF FFFE       BL               ECHO
   63 00000068 F010 0F01       TST              R0,#1
   64 0000006C D000            BEQ              ECHO_OK2
   65 0000006E E7F9            B                WAIT_ECHO2  ;µÈ´ýechoÊä³öµÍµçÆ½
                                                            
   66 00000070         ECHO_OK2
   67 00000070         ;¶ÁÊý¾Ý
   68 00000070 4980            LDR              R1,=TIM3_CNT
   69 00000072 6808            LDR              R0,[R1]
   70 00000074         ;¼ÆËã¾àÀë
   71 00000074 F7FF FFFE       BL               cal_dis
   72 00000078         ;ÏÔÊ¾
   73 00000078 F04F 0700       LDR              R7,=0
   74 0000007C F04F 030A       LDR              R3,=10
   75 00000080         DIS1
   76 00000080 FB90 F1F3       SDIV             R1,R0,R3
   77 00000084 FB01 F103       MUL              R1,R3
   78 00000088 EBA0 0201       SUB              R2,R0,R1
   79 0000008C B404            PUSH             {R2}
   80 0000008E F107 0701       ADD              R7,#1
   81 00000092 2F04            CMP              R7,#4       ;
   82 00000094 D002            BEQ              DIS2
   83 00000096 FB90 F0F3       SDIV             R0,R3
   84 0000009A E7F1            B                DIS1
   85 0000009C         DIS2
   86 0000009C F7FF FFFE       BL               UPDATE_SEG_CLRENA
   87 000000A0         DIS3
   88 000000A0 BC01            POP              {R0}
   89 000000A2 2F04            CMP              R7,#4
   90 000000A4 D006            BEQ              SEG_BIT4
   91 000000A6 2F03            CMP              R7,#3
   92 000000A8 D007            BEQ              SEG_BIT3
   93 000000AA 2F02            CMP              R7,#2
   94 000000AC D008            BEQ              SEG_BIT2
   95 000000AE 2F01            CMP              R7,#1
   96 000000B0 D009            BEQ              SEG_BIT1
   97 000000B2 E00B            B                CNT_SUB1
   98 000000B4         SEG_BIT4
   99 000000B4 4970            LDR              R1,=SEG_QIAN
  100 000000B6 6008            STR              R0,[R1]
  101 000000B8 E008            B                CNT_SUB1
  102 000000BA         SEG_BIT3
  103 000000BA 4970            LDR              R1,=SEG_BAI
  104 000000BC 6008            STR              R0,[R1]
  105 000000BE E005            B                CNT_SUB1



ARM Macro Assembler    Page 6 


  106 000000C0         SEG_BIT2
  107 000000C0 496F            LDR              R1,=SEG_SHI
  108 000000C2 6008            STR              R0,[R1]
  109 000000C4 E002            B                CNT_SUB1
  110 000000C6         SEG_BIT1
  111 000000C6 496F            LDR              R1,=SEG_GE
  112 000000C8 6008            STR              R0,[R1]
  113 000000CA E7FF            B                CNT_SUB1
  114 000000CC         CNT_SUB1
  115 000000CC F107 37FF       ADD              R7,#-1
  116 000000D0 2F00            CMP              R7,#0
  117 000000D2 D1E5            BNE              DIS3
  118 000000D4 F7FF FFFE       BL               UPDATE_SEG_SETENA
  119 000000D8         ;·­×ªLED×´Ì¬ 
  120 000000D8 F7FF FFFE       BL               TURN_LED
  121 000000DC F44F 70FA       LDR              R0,=500
  122 000000E0 F7FF FFFE       BL               DELAY_MS
  123 000000E4 E7A2            B                LOOP
  124 000000E6                 ENDP
  125 000000E6         UPDATE_SEG_SETENA
                               PROC
  126 000000E6                 EXPORT           UPDATE_SEG_SETENA
  127 000000E6 B500            PUSH             {R14}
  128 000000E8 F04F 001C       LDR              R0,=28
  129 000000EC F7FF FFFE       BL               NVIC_SETENA0_EN ;ÔÊÐíË¢ÐÂÊýÂë¹Ü
                                                            
  130 000000F0 BD00            POP              {PC}
  131 000000F2                 ENDP
  132 000000F2         UPDATE_SEG_CLRENA
                               PROC
  133 000000F2                 EXPORT           UPDATE_SEG_CLRENA
  134 000000F2 B500            PUSH             {R14}
  135 000000F4 F04F 001C       LDR              R0,=28
  136 000000F8 F7FF FFFE       BL               NVIC_CLREA0_EN
  137 000000FC BD00            POP              {PC}
  138 000000FE                 ENDP
  139 000000FE         NVIC_CLREA0_EN
                               PROC
  140 000000FE                 EXPORT           NVIC_CLREA0_EN
  141 000000FE 4603            MOV              R3,R0
  142 00000100 4861            LDR              R0,=NVIC_CLREA0
  143 00000102 6801            LDR              R1,[R0]
  144 00000104 F04F 0201       LDR              R2,=1
  145 00000108 FA02 F203       LSL              R2,R3
  146 0000010C EA41 0102       ORR              R1,R2
  147 00000110 6001            STR              R1,[R0]     ;
  148 00000112 4770            BX               R14
  149 00000114                 ENDP
  150 00000114         NVIC_SETENA0_EN
                               PROC
  151 00000114                 EXPORT           NVIC_SETENA0_EN
  152 00000114 4618            MOV              R0,R3
  153 00000116 485D            LDR              R0,=NVIC_SETENA0
  154 00000118 6801            LDR              R1,[R0]
  155 0000011A F04F 0201       LDR              R2,=1
  156 0000011E FA02 F203       LSL              R2,R3
  157 00000122 EA41 0102       ORR              R1,R2
  158 00000126 6001            STR              R1,[R0]
  159 00000128 4770            BX               R14



ARM Macro Assembler    Page 7 


  160 0000012A                 ENDP
  161 0000012A         DELAY_US
                               PROC                         ;×î´óÑÓÊ±£º2,796,20
                                                            0us
  162 0000012A                 EXPORT           DELAY_US
  163 0000012A         ;¼ÆËãÖØÔØÖµ
  164 0000012A F04F 0106       LDR              R1,=6
  165 0000012E FB00 F001       MUL              R0,R1
  166 00000132         ;×°ÈëÖØÔØÖµ
  167 00000132 4957            LDR              R1,=SYSTICK_RELOAD
  168 00000134 6008            STR              R0,[R1]
  169 00000136         ;Çå¿Õ¼ÆÊýÆ÷
  170 00000136 4857            LDR              R0,=SYSTICK_CURRENT
  171 00000138 F04F 0100       LDR              R1,=0
  172 0000013C 6001            STR              R1,[R0]
  173 0000013E         ;Æô¶¯¼ÆÊ±Æ÷
  174 0000013E 4856            LDR              R0,=SYSTICK_CSR
  175 00000140 6802            LDR              R2,[R0]
  176 00000142 F042 0201       ORR              R2,#1
  177 00000146 6002            STR              R2,[R0]
  178 00000148         READ_CURRENTFLAG_US                  ;µÈ´ýÊ±¼äµ½´ï 
  179 00000148 6801            LDR              R1,[R0]
  180 0000014A F411 3F80       TST              R1,#0X10000
  181 0000014E D0FB            BEQ              READ_CURRENTFLAG_US
  182 00000150         ;¹Ø±Õ¼ÆÊ±Æ÷
  183 00000150 4851            LDR              R0,=SYSTICK_CSR
  184 00000152 6802            LDR              R2,[R0]
  185 00000154 F022 0201       BIC              R2,#1
  186 00000158 6002            STR              R2,[R0]
  187 0000015A 4770            BX               R14
  188 0000015C                 ENDP
  189 0000015C         DELAY_MS
                               PROC                         ;×î´óÑÓÊ±2,796ms
  190 0000015C                 EXPORT           DELAY_MS
  191 0000015C         ;¼ÆËãÖØÔØÖµ
  192 0000015C F241 7170       LDR              R1,=6000
  193 00000160 FB00 F001       MUL              R0,R1
  194 00000164         ;×°ÈëÖØÔØÖµ
  195 00000164 494A            LDR              R1,=SYSTICK_RELOAD
  196 00000166 6008            STR              R0,[R1]
  197 00000168         ;Çå¿Õ¼ÆÊýÆ÷
  198 00000168 484A            LDR              R0,=SYSTICK_CURRENT
  199 0000016A F04F 0100       LDR              R1,=0
  200 0000016E 6001            STR              R1,[R0]
  201 00000170         ;Æô¶¯¶¨Ê±Æ÷
  202 00000170 4849            LDR              R0,=SYSTICK_CSR
  203 00000172 6802            LDR              R2,[R0]
  204 00000174 F042 0201       ORR              R2,#1
  205 00000178 6002            STR              R2,[R0]
  206 0000017A         READ_CURRENTFLAG_MS                  ;µÈ´ýÊ±¼äµ½´ï 
  207 0000017A 6801            LDR              R1,[R0]
  208 0000017C F411 3F80       TST              R1,#0X10000
  209 00000180 D0FB            BEQ              READ_CURRENTFLAG_MS
  210 00000182         ;¹Ø±Õ¶¨Ê±Æ÷
  211 00000182 4845            LDR              R0,=SYSTICK_CSR
  212 00000184 6802            LDR              R2,[R0]
  213 00000186 F022 0201       BIC              R2,#1
  214 0000018A 6002            STR              R2,[R0]
  215 0000018C 4770            BX               R14



ARM Macro Assembler    Page 8 


  216 0000018E                 ENDP
  217 0000018E         SET_AN  PROC
  218 0000018E                 EXPORT           SET_AN
  219 0000018E 4603            MOV              R3,R0
  220 00000190 4842            LDR              R0,=GPIOA_ODR
  221 00000192 6801            LDR              R1,[R0]
  222 00000194 F04F 0201       LDR              R2,=0X1
  223 00000198 FA02 F203       LSL              R2,R3
  224 0000019C EA41 0102       ORR              R1,R2
  225 000001A0 6001            STR              R1,[R0]
  226 000001A2 4770            BX               R14
  227 000001A4                 ENDP
  228 000001A4         RESET_AN
                               PROC
  229 000001A4                 EXPORT           RESET_AN
  230 000001A4 4603            MOV              R3,R0
  231 000001A6 483D            LDR              R0,=GPIOA_ODR
  232 000001A8 6801            LDR              R1,[R0]
  233 000001AA F04F 0201       LDR              R2,=0X1
  234 000001AE FA02 F203       LSL              R2,R3
  235 000001B2 EA21 0102       BIC              R1,R2
  236 000001B6 6001            STR              R1,[R0]
  237 000001B8 4770            BX               R14
  238 000001BA                 ENDP
  239 000001BA         SET_BN  PROC
  240 000001BA                 EXPORT           SET_BN
  241 000001BA 4603            MOV              R3,R0
  242 000001BC 4838            LDR              R0,=GPIOB_ODR
  243 000001BE 6801            LDR              R1,[R0]
  244 000001C0 F04F 0201       LDR              R2,=0X1
  245 000001C4 FA02 F203       LSL              R2,R3
  246 000001C8 EA41 0102       ORR              R1,R2
  247 000001CC 6001            STR              R1,[R0]
  248 000001CE 4770            BX               R14
  249 000001D0                 ENDP
  250 000001D0         RESET_BN
                               PROC
  251 000001D0                 EXPORT           RESET_BN
  252 000001D0 4603            MOV              R3,R0
  253 000001D2 4833            LDR              R0,=GPIOB_ODR
  254 000001D4 6801            LDR              R1,[R0]
  255 000001D6 F04F 0201       LDR              R2,=0X1
  256 000001DA FA02 F203       LSL              R2,R3
  257 000001DE EA21 0102       BIC              R1,R2
  258 000001E2 6001            STR              R1,[R0]
  259 000001E4 4770            BX               R14
  260 000001E6                 ENDP
  261 000001E6         READ_BN PROC
  262 000001E6 4603            MOV              R3,R0
  263 000001E8 482E            LDR              R0,=GPIOB_IDR
  264 000001EA 6801            LDR              R1,[R0]
  265 000001EC F04F 0001       LDR              R0,=0X1
  266 000001F0 FA00 F003       LSL              R0,R3
  267 000001F4 4201            TST              R1,R0
  268 000001F6 BF14 2001       LDRNE            R0,=0X1
  269 000001FA 2000            LDREQ            R0,=0X0
  270 000001FC 4770            BX               R14
  271 000001FE                 ENDP
  272 000001FE         SET_CN  PROC



ARM Macro Assembler    Page 9 


  273 000001FE                 EXPORT           SET_CN
  274 000001FE 4603            MOV              R3,R0
  275 00000200 4829            LDR              R0,=GPIOC_ODR
  276 00000202 6801            LDR              R1,[R0]
  277 00000204 F04F 0201       LDR              R2,=0X1
  278 00000208 FA02 F203       LSL              R2,R3
  279 0000020C EA41 0102       ORR              R1,R2
  280 00000210 6001            STR              R1,[R0]
  281 00000212 4770            BX               R14
  282 00000214                 ENDP
  283 00000214         RESET_CN
                               PROC
  284 00000214                 EXPORT           RESET_CN
  285 00000214 4603            MOV              R3,R0
  286 00000216 4824            LDR              R0,=GPIOC_ODR
  287 00000218 6801            LDR              R1,[R0]
  288 0000021A F04F 0201       LDR              R2,=0X1
  289 0000021E FA02 F203       LSL              R2,R3
  290 00000222 EA21 0102       BIC              R1,R2
  291 00000226 6001            STR              R1,[R0]
  292 00000228 4770            BX               R14
  293 0000022A                 ENDP
  294 0000022A         TURN_CN PROC
  295 0000022A                 EXPORT           TURN_CN
  296 0000022A 4603            MOV              R3,R0
  297 0000022C 481E            LDR              R0,=GPIOC_ODR
  298 0000022E 6801            LDR              R1,[R0]
  299 00000230 F04F 0201       LDR              R2,=0X1
  300 00000234 FA02 F203       LSL              R2,R3
  301 00000238 EA81 0102       EOR              R1,R2
  302 0000023C 6001            STR              R1,[R0]
  303 0000023E 4770            BX               R14
  304 00000240                 ENDP
  305 00000240         TURN_LED
                               PROC
  306 00000240                 EXPORT           TURN_LED
  307 00000240 B500            PUSH             {R14}
  308 00000242 F04F 000D       LDR              R0,=13
  309 00000246 F7FF FFFE       BL               TURN_CN
  310 0000024A BD00            POP              {PC}
  311 0000024C                 ENDP
  312 0000024C         TRIG_H  PROC
  313 0000024C                 EXPORT           TRIG_H
  314 0000024C B500            PUSH             {R14}
  315 0000024E F04F 0000       LDR              R0,=0X0
  316 00000252 F7FF FFFE       BL               SET_BN
  317 00000256 BD00            POP              {PC}
  318 00000258                 ENDP
  319 00000258         
  320 00000258         TRIG_L  PROC
  321 00000258                 EXPORT           TRIG_L
  322 00000258 B500            PUSH             {R14}
  323 0000025A F04F 0000       LDR              R0,=0X0
  324 0000025E F7FF FFFE       BL               RESET_BN
  325 00000262 BD00            POP              {PC}
  326 00000264                 ENDP
  327 00000264         
  328 00000264         ECHO    PROC
  329 00000264                 EXPORT           ECHO



ARM Macro Assembler    Page 10 


  330 00000264 B500            PUSH             {R14}
  331 00000266 F04F 0001       LDR              R0,=0X1
  332 0000026A F7FF FFFE       BL               READ_BN
  333 0000026E BD00            POP              {PC}
  334 00000270                 ENDP
  335 00000270                 ALIGN
  336 00000270                 END                          ;»ã±à´úÂë½áÊø
              20004910 
              40000424 
              20004900 
              20004904 
              20004908 
              2000490C 
              E000E180 
              E000E100 
              E000E014 
              E000E018 
              E000E010 
              4001080C 
              40010C0C 
              40010C08 
              4001100C 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\objects\startup.d -o.\objects\startup.o -IE:\STM32p³¬Éù²¨²â¾à´«¸
ÐÆ÷pÊýÂë¹ÜpÔ­ÀíÍ¼pARM»ã±àÊµÏÖeÊµÏÖ9999ºÁÃ×ÄÚµÄ²â¾à\cgq\RTE -ID:\Keil_v5\ARM\PAC
K\Keil\STM32F1xx_DFP\2.2.0 -ID:\Keil_v5\ARM\CMSIS\Include --predefine="__UVISIO
N_VERSION SETA 514" --predefine="STM32F10X_MD SETA 1" --list=.\listings\startup
.lst startup.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

HEADER 00000000

Symbol: HEADER
   Definitions
      At line 63 in file common.s
   Uses
      None
Comment: HEADER unused
1 symbol



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

MY_DATA 00000000

Symbol: MY_DATA
   Definitions
      At line 12 in file startup.s
   Uses
      None
Comment: MY_DATA unused
__Vectors 00000000

Symbol: __Vectors
   Definitions
      At line 14 in file startup.s
   Uses
      At line 13 in file startup.s
Comment: __Vectors used once
2 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CNT_SUB1 000000CC

Symbol: CNT_SUB1
   Definitions
      At line 114 in file startup.s
   Uses
      At line 97 in file startup.s
      At line 101 in file startup.s
      At line 105 in file startup.s
      At line 109 in file startup.s
      At line 113 in file startup.s

DELAY_MS 0000015C

Symbol: DELAY_MS
   Definitions
      At line 189 in file startup.s
   Uses
      At line 37 in file startup.s
      At line 122 in file startup.s
      At line 190 in file startup.s

DELAY_US 0000012A

Symbol: DELAY_US
   Definitions
      At line 161 in file startup.s
   Uses
      At line 42 in file startup.s
      At line 162 in file startup.s

DIS1 00000080

Symbol: DIS1
   Definitions
      At line 75 in file startup.s
   Uses
      At line 84 in file startup.s
Comment: DIS1 used once
DIS2 0000009C

Symbol: DIS2
   Definitions
      At line 85 in file startup.s
   Uses
      At line 82 in file startup.s
Comment: DIS2 used once
DIS3 000000A0

Symbol: DIS3
   Definitions
      At line 87 in file startup.s
   Uses
      At line 117 in file startup.s
Comment: DIS3 used once
ECHO 00000264

Symbol: ECHO
   Definitions



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

      At line 328 in file startup.s
   Uses
      At line 47 in file startup.s
      At line 62 in file startup.s
      At line 329 in file startup.s

ECHO_OK2 00000070

Symbol: ECHO_OK2
   Definitions
      At line 66 in file startup.s
   Uses
      At line 64 in file startup.s
Comment: ECHO_OK2 used once
LOOP 0000002C

Symbol: LOOP
   Definitions
      At line 38 in file startup.s
   Uses
      At line 52 in file startup.s
      At line 123 in file startup.s

MY_CODE 00000000

Symbol: MY_CODE
   Definitions
      At line 22 in file startup.s
   Uses
      None
Comment: MY_CODE unused
NVIC_CLREA0_EN 000000FE

Symbol: NVIC_CLREA0_EN
   Definitions
      At line 139 in file startup.s
   Uses
      At line 136 in file startup.s
      At line 140 in file startup.s

NVIC_SETENA0_EN 00000114

Symbol: NVIC_SETENA0_EN
   Definitions
      At line 150 in file startup.s
   Uses
      At line 129 in file startup.s
      At line 151 in file startup.s

READ_BN 000001E6

Symbol: READ_BN
   Definitions
      At line 261 in file startup.s
   Uses
      At line 332 in file startup.s
Comment: READ_BN used once
READ_CURRENTFLAG_MS 0000017A




ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

Symbol: READ_CURRENTFLAG_MS
   Definitions
      At line 206 in file startup.s
   Uses
      At line 209 in file startup.s
Comment: READ_CURRENTFLAG_MS used once
READ_CURRENTFLAG_US 00000148

Symbol: READ_CURRENTFLAG_US
   Definitions
      At line 178 in file startup.s
   Uses
      At line 181 in file startup.s
Comment: READ_CURRENTFLAG_US used once
RESET_AN 000001A4

Symbol: RESET_AN
   Definitions
      At line 228 in file startup.s
   Uses
      At line 229 in file startup.s
Comment: RESET_AN used once
RESET_BN 000001D0

Symbol: RESET_BN
   Definitions
      At line 250 in file startup.s
   Uses
      At line 251 in file startup.s
      At line 324 in file startup.s

RESET_CN 00000214

Symbol: RESET_CN
   Definitions
      At line 283 in file startup.s
   Uses
      At line 284 in file startup.s
Comment: RESET_CN used once
Reset_Handler 00000000

Symbol: Reset_Handler
   Definitions
      At line 23 in file startup.s
   Uses
      At line 16 in file startup.s
      At line 24 in file startup.s

SEG_BIT1 000000C6

Symbol: SEG_BIT1
   Definitions
      At line 110 in file startup.s
   Uses
      At line 96 in file startup.s
Comment: SEG_BIT1 used once
SEG_BIT2 000000C0

Symbol: SEG_BIT2



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 106 in file startup.s
   Uses
      At line 94 in file startup.s
Comment: SEG_BIT2 used once
SEG_BIT3 000000BA

Symbol: SEG_BIT3
   Definitions
      At line 102 in file startup.s
   Uses
      At line 92 in file startup.s
Comment: SEG_BIT3 used once
SEG_BIT4 000000B4

Symbol: SEG_BIT4
   Definitions
      At line 98 in file startup.s
   Uses
      At line 90 in file startup.s
Comment: SEG_BIT4 used once
SET_AN 0000018E

Symbol: SET_AN
   Definitions
      At line 217 in file startup.s
   Uses
      At line 218 in file startup.s
Comment: SET_AN used once
SET_BN 000001BA

Symbol: SET_BN
   Definitions
      At line 239 in file startup.s
   Uses
      At line 240 in file startup.s
      At line 316 in file startup.s

SET_CN 000001FE

Symbol: SET_CN
   Definitions
      At line 272 in file startup.s
   Uses
      At line 273 in file startup.s
Comment: SET_CN used once
TRIG_H 0000024C

Symbol: TRIG_H
   Definitions
      At line 312 in file startup.s
   Uses
      At line 40 in file startup.s
      At line 313 in file startup.s

TRIG_L 00000258

Symbol: TRIG_L
   Definitions



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Relocatable symbols

      At line 320 in file startup.s
   Uses
      At line 44 in file startup.s
      At line 321 in file startup.s

TURN_CN 0000022A

Symbol: TURN_CN
   Definitions
      At line 294 in file startup.s
   Uses
      At line 295 in file startup.s
      At line 309 in file startup.s

TURN_LED 00000240

Symbol: TURN_LED
   Definitions
      At line 305 in file startup.s
   Uses
      At line 120 in file startup.s
      At line 306 in file startup.s

UPDATE_SEG_CLRENA 000000F2

Symbol: UPDATE_SEG_CLRENA
   Definitions
      At line 132 in file startup.s
   Uses
      At line 86 in file startup.s
      At line 133 in file startup.s

UPDATE_SEG_SETENA 000000E6

Symbol: UPDATE_SEG_SETENA
   Definitions
      At line 125 in file startup.s
   Uses
      At line 118 in file startup.s
      At line 126 in file startup.s

WAIT_ECHO1 00000040

Symbol: WAIT_ECHO1
   Definitions
      At line 46 in file startup.s
   Uses
      At line 55 in file startup.s
Comment: WAIT_ECHO1 used once
WAIT_ECHO2 00000064

Symbol: WAIT_ECHO2
   Definitions
      At line 61 in file startup.s
   Uses
      At line 65 in file startup.s
Comment: WAIT_ECHO2 used once
34 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

GPIOA_CRL 40010800

Symbol: GPIOA_CRL
   Definitions
      At line 8 in file common.s
   Uses
      None
Comment: GPIOA_CRL unused
GPIOA_IDR 40010808

Symbol: GPIOA_IDR
   Definitions
      At line 9 in file common.s
   Uses
      None
Comment: GPIOA_IDR unused
GPIOA_ODR 4001080C

Symbol: GPIOA_ODR
   Definitions
      At line 10 in file common.s
   Uses
      At line 220 in file startup.s
      At line 231 in file startup.s

GPIOB_CRH 40010C04

Symbol: GPIOB_CRH
   Definitions
      At line 12 in file common.s
   Uses
      None
Comment: GPIOB_CRH unused
GPIOB_CRL 40010C00

Symbol: GPIOB_CRL
   Definitions
      At line 11 in file common.s
   Uses
      None
Comment: GPIOB_CRL unused
GPIOB_IDR 40010C08

Symbol: GPIOB_IDR
   Definitions
      At line 13 in file common.s
   Uses
      At line 263 in file startup.s
Comment: GPIOB_IDR used once
GPIOB_ODR 40010C0C

Symbol: GPIOB_ODR
   Definitions
      At line 14 in file common.s
   Uses
      At line 242 in file startup.s
      At line 253 in file startup.s

GPIOC_CRH 40011004



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols


Symbol: GPIOC_CRH
   Definitions
      At line 15 in file common.s
   Uses
      None
Comment: GPIOC_CRH unused
GPIOC_ODR 4001100C

Symbol: GPIOC_ODR
   Definitions
      At line 16 in file common.s
   Uses
      At line 275 in file startup.s
      At line 286 in file startup.s
      At line 297 in file startup.s

IWDG_KR 40003000

Symbol: IWDG_KR
   Definitions
      At line 38 in file common.s
   Uses
      None
Comment: IWDG_KR unused
IWDG_PR 40003004

Symbol: IWDG_PR
   Definitions
      At line 39 in file common.s
   Uses
      None
Comment: IWDG_PR unused
IWDG_RLR 40003008

Symbol: IWDG_RLR
   Definitions
      At line 40 in file common.s
   Uses
      None
Comment: IWDG_RLR unused
IWDG_SR 4000300C

Symbol: IWDG_SR
   Definitions
      At line 41 in file common.s
   Uses
      None
Comment: IWDG_SR unused
NVIC_CLREA0 E000E180

Symbol: NVIC_CLREA0
   Definitions
      At line 33 in file common.s
   Uses
      At line 142 in file startup.s
Comment: NVIC_CLREA0 used once
NVIC_CLRPEN E000E280




ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

Symbol: NVIC_CLRPEN
   Definitions
      At line 34 in file common.s
   Uses
      None
Comment: NVIC_CLRPEN unused
NVIC_SETENA0 E000E100

Symbol: NVIC_SETENA0
   Definitions
      At line 32 in file common.s
   Uses
      At line 153 in file startup.s
Comment: NVIC_SETENA0 used once
RCC_APB1ENR 4002101C

Symbol: RCC_APB1ENR
   Definitions
      At line 18 in file common.s
   Uses
      None
Comment: RCC_APB1ENR unused
RCC_APB2ENR 40021018

Symbol: RCC_APB2ENR
   Definitions
      At line 17 in file common.s
   Uses
      None
Comment: RCC_APB2ENR unused
RCC_CFGR 40021004

Symbol: RCC_CFGR
   Definitions
      At line 20 in file common.s
   Uses
      None
Comment: RCC_CFGR unused
RCC_CR 40021000

Symbol: RCC_CR
   Definitions
      At line 19 in file common.s
   Uses
      None
Comment: RCC_CR unused
SEG_BAI 20004904

Symbol: SEG_BAI
   Definitions
      At line 3 in file common.s
   Uses
      At line 103 in file startup.s
Comment: SEG_BAI used once
SEG_CNT 20004910

Symbol: SEG_CNT
   Definitions
      At line 6 in file common.s



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Absolute symbols

   Uses
      At line 33 in file startup.s
Comment: SEG_CNT used once
SEG_GE 2000490C

Symbol: SEG_GE
   Definitions
      At line 5 in file common.s
   Uses
      At line 111 in file startup.s
Comment: SEG_GE used once
SEG_QIAN 20004900

Symbol: SEG_QIAN
   Definitions
      At line 2 in file common.s
   Uses
      At line 99 in file startup.s
Comment: SEG_QIAN used once
SEG_SHI 20004908

Symbol: SEG_SHI
   Definitions
      At line 4 in file common.s
   Uses
      At line 107 in file startup.s
Comment: SEG_SHI used once
SYSTICK_CSR E000E010

Symbol: SYSTICK_CSR
   Definitions
      At line 35 in file common.s
   Uses
      At line 174 in file startup.s
      At line 183 in file startup.s
      At line 202 in file startup.s
      At line 211 in file startup.s

SYSTICK_CURRENT E000E018

Symbol: SYSTICK_CURRENT
   Definitions
      At line 37 in file common.s
   Uses
      At line 170 in file startup.s
      At line 198 in file startup.s

SYSTICK_RELOAD E000E014

Symbol: SYSTICK_RELOAD
   Definitions
      At line 36 in file common.s
   Uses
      At line 167 in file startup.s
      At line 195 in file startup.s

TIM2_ARR 4000002C

Symbol: TIM2_ARR



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Absolute symbols

   Definitions
      At line 23 in file common.s
   Uses
      None
Comment: TIM2_ARR unused
TIM2_CR1 40000000

Symbol: TIM2_CR1
   Definitions
      At line 21 in file common.s
   Uses
      None
Comment: TIM2_CR1 unused
TIM2_DIER 4000000C

Symbol: TIM2_DIER
   Definitions
      At line 24 in file common.s
   Uses
      None
Comment: TIM2_DIER unused
TIM2_PSC 40000028

Symbol: TIM2_PSC
   Definitions
      At line 22 in file common.s
   Uses
      None
Comment: TIM2_PSC unused
TIM2_SR 40000010

Symbol: TIM2_SR
   Definitions
      At line 25 in file common.s
   Uses
      None
Comment: TIM2_SR unused
TIM3_ARR 4000042C

Symbol: TIM3_ARR
   Definitions
      At line 28 in file common.s
   Uses
      None
Comment: TIM3_ARR unused
TIM3_CNT 40000424

Symbol: TIM3_CNT
   Definitions
      At line 31 in file common.s
   Uses
      At line 57 in file startup.s
      At line 68 in file startup.s

TIM3_CR1 40000400

Symbol: TIM3_CR1
   Definitions
      At line 26 in file common.s



ARM Macro Assembler    Page 6 Alphabetic symbol ordering
Absolute symbols

   Uses
      None
Comment: TIM3_CR1 unused
TIM3_DIER 4000040C

Symbol: TIM3_DIER
   Definitions
      At line 29 in file common.s
   Uses
      None
Comment: TIM3_DIER unused
TIM3_PSC 40000428

Symbol: TIM3_PSC
   Definitions
      At line 27 in file common.s
   Uses
      None
Comment: TIM3_PSC unused
TIM3_SR 40000410

Symbol: TIM3_SR
   Definitions
      At line 30 in file common.s
   Uses
      None
Comment: TIM3_SR unused
39 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

CLK_CFG 00000000

Symbol: CLK_CFG
   Definitions
      At line 6 in file startup.s
   Uses
      At line 26 in file startup.s
Comment: CLK_CFG used once
DP_OFF 00000000

Symbol: DP_OFF
   Definitions
      At line 62 in file common.s
   Uses
      None
Comment: DP_OFF unused
DP_ON 00000000

Symbol: DP_ON
   Definitions
      At line 57 in file common.s
   Uses
      None
Comment: DP_ON unused
IO_CFG 00000000

Symbol: IO_CFG
   Definitions
      At line 5 in file startup.s
   Uses
      At line 27 in file startup.s
Comment: IO_CFG used once
IWDG_CFG 00000000

Symbol: IWDG_CFG
   Definitions
      At line 10 in file startup.s
   Uses
      At line 31 in file startup.s
Comment: IWDG_CFG used once
RCC_CFG 00000000

Symbol: RCC_CFG
   Definitions
      At line 2 in file startup.s
   Uses
      At line 25 in file startup.s
Comment: RCC_CFG used once
SHOW0 00000000

Symbol: SHOW0
   Definitions
      At line 43 in file common.s
   Uses
      None
Comment: SHOW0 unused
SHOW1 00000000

Symbol: SHOW1



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

   Definitions
      At line 44 in file common.s
   Uses
      None
Comment: SHOW1 unused
SHOW2 00000000

Symbol: SHOW2
   Definitions
      At line 45 in file common.s
   Uses
      None
Comment: SHOW2 unused
SHOW3 00000000

Symbol: SHOW3
   Definitions
      At line 46 in file common.s
   Uses
      None
Comment: SHOW3 unused
SHOW4 00000000

Symbol: SHOW4
   Definitions
      At line 47 in file common.s
   Uses
      None
Comment: SHOW4 unused
SHOW5 00000000

Symbol: SHOW5
   Definitions
      At line 48 in file common.s
   Uses
      None
Comment: SHOW5 unused
SHOW6 00000000

Symbol: SHOW6
   Definitions
      At line 49 in file common.s
   Uses
      None
Comment: SHOW6 unused
SHOW7 00000000

Symbol: SHOW7
   Definitions
      At line 50 in file common.s
   Uses
      None
Comment: SHOW7 unused
SHOW8 00000000

Symbol: SHOW8
   Definitions
      At line 51 in file common.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
External symbols

      None
Comment: SHOW8 unused
SHOW9 00000000

Symbol: SHOW9
   Definitions
      At line 52 in file common.s
   Uses
      None
Comment: SHOW9 unused
SYSTICK_CLK_SOURCE 00000000

Symbol: SYSTICK_CLK_SOURCE
   Definitions
      At line 8 in file startup.s
   Uses
      At line 30 in file startup.s
Comment: SYSTICK_CLK_SOURCE used once
TIM2_CFG 00000000

Symbol: TIM2_CFG
   Definitions
      At line 4 in file startup.s
   Uses
      At line 28 in file startup.s
Comment: TIM2_CFG used once
TIM2_IRQHandler 00000000

Symbol: TIM2_IRQHandler
   Definitions
      At line 3 in file startup.s
   Uses
      At line 20 in file startup.s
Comment: TIM2_IRQHandler used once
TIM3_CFG 00000000

Symbol: TIM3_CFG
   Definitions
      At line 9 in file startup.s
   Uses
      At line 29 in file startup.s
Comment: TIM3_CFG used once
W1_OFF 00000000

Symbol: W1_OFF
   Definitions
      At line 58 in file common.s
   Uses
      None
Comment: W1_OFF unused
W1_ON 00000000

Symbol: W1_ON
   Definitions
      At line 53 in file common.s
   Uses
      None
Comment: W1_ON unused
W2_OFF 00000000



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
External symbols


Symbol: W2_OFF
   Definitions
      At line 59 in file common.s
   Uses
      None
Comment: W2_OFF unused
W2_ON 00000000

Symbol: W2_ON
   Definitions
      At line 54 in file common.s
   Uses
      None
Comment: W2_ON unused
W3_OFF 00000000

Symbol: W3_OFF
   Definitions
      At line 60 in file common.s
   Uses
      None
Comment: W3_OFF unused
W3_ON 00000000

Symbol: W3_ON
   Definitions
      At line 55 in file common.s
   Uses
      None
Comment: W3_ON unused
W4_OFF 00000000

Symbol: W4_OFF
   Definitions
      At line 61 in file common.s
   Uses
      None
Comment: W4_OFF unused
W4_ON 00000000

Symbol: W4_ON
   Definitions
      At line 56 in file common.s
   Uses
      None
Comment: W4_ON unused
cal_dis 00000000

Symbol: cal_dis
   Definitions
      At line 7 in file startup.s
   Uses
      At line 71 in file startup.s
Comment: cal_dis used once
29 symbols
439 symbols in table
